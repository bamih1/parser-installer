<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Parser Dashboard</title>
    <style>
        :root {
            --color-primary: #2186b6;
            --color-success: #10b981;
            --color-error: #ef4444;
            --color-warning: #f59e0b;
            --color-bg: #0f172a;
            --color-surface: #1e293b;
            --color-text: #f1f5f9;
            --color-border: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: var(--color-surface);
            padding: 20px;
            border-bottom: 1px solid var(--color-border);
            margin-bottom: 30px;
            border-radius: 8px;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .subtitle {
            color: #cbd5e1;
            font-size: 14px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--color-surface);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
        }

        .card h3 {
            margin-bottom: 15px;
            font-size: 16px;
            color: var(--color-primary);
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            color: #94a3b8;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            background: var(--color-bg);
            border: 1px solid var(--color-border);
            border-radius: 6px;
            color: var(--color-text);
            font-size: 14px;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(33, 134, 182, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: #1e5a8f;
            transform: translateY(-2px);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--color-surface);
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }

        .btn-secondary:hover {
            background: #334155;
        }

        .status-box {
            background: var(--color-bg);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--color-border);
            margin-top: 10px;
            font-size: 13px;
            font-family: 'Courier New', monospace;
        }

        .status-success {
            border-left-color: var(--color-success);
            background: rgba(16, 185, 129, 0.05);
            color: #6ee7b7;
        }

        .status-error {
            border-left-color: var(--color-error);
            background: rgba(239, 68, 68, 0.05);
            color: #fca5a5;
        }

        .status-warning {
            border-left-color: var(--color-warning);
            background: rgba(245, 158, 11, 0.05);
            color: #fcd34d;
        }

        .status-info {
            border-left-color: var(--color-primary);
            background: rgba(33, 134, 182, 0.05);
            color: #7dd3fc;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-right: 8px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .results {
            background: var(--color-surface);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            margin-top: 20px;
        }

        .result-item {
            background: var(--color-bg);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 4px solid var(--color-primary);
        }

        .result-item h4 {
            margin-bottom: 8px;
            color: var(--color-primary);
        }

        .price {
            font-size: 18px;
            font-weight: bold;
            color: var(--color-success);
            margin: 5px 0;
        }

        .tabs {
            display: flex;
            gap: 10px;
            border-bottom: 1px solid var(--color-border);
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 15px;
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            font-weight: 600;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .code-block {
            background: var(--color-bg);
            padding: 15px;
            border-radius: 6px;
            border: 1px solid var(--color-border);
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.5;
            color: #7dd3fc;
        }

        .endpoint-doc {
            background: var(--color-bg);
            padding: 15px;
            border-radius: 6px;
            border-left: 3px solid var(--color-primary);
            margin-bottom: 15px;
            font-size: 13px;
        }

        .method {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 11px;
            margin-right: 10px;
        }

        .method-post {
            background: rgba(34, 197, 94, 0.2);
            color: #6ee7b7;
        }

        .method-get {
            background: rgba(33, 134, 182, 0.2);
            color: #7dd3fc;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç E-Commerce Parser API</h1>
            <p class="subtitle">–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–æ–≤ –æ–¥–µ–∂–¥—ã —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π n8n</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="switchTab(event, 'parser')">–ü–∞—Ä—Å–µ—Ä</button>
            <button class="tab" onclick="switchTab(event, 'config')">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</button>
            <button class="tab" onclick="switchTab(event, 'docs')">API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</button>
            <button class="tab" onclick="switchTab(event, 'n8n')">n8n –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</button>
        </div>

        <!-- Parser Tab -->
        <div id="parser" class="tab-content active">
            <div class="grid">
                <div class="card">
                    <h3>üìä –ë—ã—Å—Ç—Ä—ã–π –ø–∞—Ä—Å–∏–Ω–≥</h3>
                    <div class="form-group">
                        <label>URL –º–∞–≥–∞–∑–∏–Ω–∞</label>
                        <input type="text" id="parserUrl" placeholder="https://example.com/catalog/...">
                    </div>
                    <div class="form-group">
                        <label>–°–µ–ª–µ–∫—Ç–æ—Ä —Ç–æ–≤–∞—Ä–æ–≤ (CSS)</label>
                        <input type="text" id="parserSelector" placeholder=".product, [data-product], div.item">
                    </div>
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                        <input type="text" id="parserName" placeholder=".product-name, .title, h2">
                    </div>
                    <div class="form-group">
                        <label>–¶–µ–Ω–∞ (CSS —Å–µ–ª–µ–∫—Ç–æ—Ä)</label>
                        <input type="text" id="parserPrice" placeholder=".price, [data-price], .cost">
                    </div>
                    <div class="form-group">
                        <label>–°–æ—Å—Ç–∞–≤ —Ç–∫–∞–Ω–∏ (CSS —Å–µ–ª–µ–∫—Ç–æ—Ä)</label>
                        <input type="text" id="parserComposition" placeholder=".composition, .material, [data-fabric]">
                    </div>
                    <div class="form-group">
                        <label>–ê–∫—Ü–∏–∏/—Å–∫–∏–¥–∫–∏ (CSS —Å–µ–ª–µ–∫—Ç–æ—Ä)</label>
                        <input type="text" id="parserDiscount" placeholder=".discount, .sale, .promo">
                    </div>
                    <div class="button-group">
                        <button class="btn-primary" onclick="parseNow()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥</button>
                        <button class="btn-secondary" onclick="resetParser()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                    <div id="parserStatus"></div>
                </div>

                <div class="card">
                    <h3>‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—Å–∏–Ω–≥–∞</h3>
                    <div class="form-group">
                        <label>–ú–∞–∫—Å–∏–º—É–º —Ç–æ–≤–∞—Ä–æ–≤</label>
                        <input type="number" id="parserLimit" value="50" min="1" max="1000">
                    </div>
                    <div class="form-group">
                        <label>–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (ms)</label>
                        <input type="number" id="parserDelay" value="500" min="100" max="5000">
                    </div>
                    <div class="form-group">
                        <label>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±—Ä–∞—É–∑–µ—Ä</label>
                        <select id="parserBrowser">
                            <option value="false">–ù–µ—Ç (–±—ã—Å—Ç—Ä–µ–µ, Cheerio)</option>
                            <option value="true">–î–∞ (Puppeteer –¥–ª—è JS)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>User-Agent</label>
                        <textarea id="parserUserAgent">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36</textarea>
                    </div>
                </div>
            </div>

            <div class="results" id="resultsContainer" style="display: none;">
                <h3>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞</h3>
                <div id="resultsList"></div>
            </div>
        </div>

        <!-- Config Tab -->
        <div id="config" class="tab-content">
            <div class="card">
                <h3>üõ†Ô∏è –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –º–∞–≥–∞–∑–∏–Ω–∞</h3>
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞</label>
                    <input type="text" id="configName" placeholder="–ü—Ä–∏–º–µ—Ä: 'Sarto Reale', 'Albione'">
                </div>
                <div class="form-group">
                    <label>–î–æ–º–µ–Ω –º–∞–≥–∞–∑–∏–Ω–∞</label>
                    <input type="text" id="configDomain" placeholder="example.com –∏–ª–∏ https://example.com">
                </div>
                <div class="form-group">
                    <label>JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</label>
                    <textarea id="configJson">{
  "selectors": {
    "products": ".product",
    "name": ".product-name",
    "price": ".price",
    "composition": ".composition",
    "discount": ".discount"
  },
  "pagination": {
    "enabled": true,
    "nextButton": "a.next",
    "maxPages": 5
  },
  "delay": 500,
  "browser": false
}</textarea>
                </div>
                <div class="button-group">
                    <button class="btn-primary" onclick="saveConfig()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é</button>
                    <button class="btn-secondary" onclick="loadConfigs()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏</button>
                </div>
                <div id="configStatus"></div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">üìÅ –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h3>
                <div id="configsList"></div>
            </div>
        </div>

        <!-- Docs Tab -->
        <div id="docs" class="tab-content">
            <div class="card">
                <h3>üìñ REST API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</h3>

                <div class="endpoint-doc">
                    <span class="method method-post">POST</span>
                    <strong>/api/parse</strong>
                    <p style="margin-top: 8px;">–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ URL –ø–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</p>
                    <div class="code-block" style="margin-top: 10px;">
curl -X POST http://localhost:3000/api/parse \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://albione.ru/catalog/suits/",
    "configName": "albione",
    "limit": 50
  }'
                    </div>
                </div>

                <div class="endpoint-doc">
                    <span class="method method-post">POST</span>
                    <strong>/api/parse-custom</strong>
                    <p style="margin-top: 8px;">–ü–∞—Ä—Å–∏–Ω–≥ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏ (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)</p>
                    <div class="code-block" style="margin-top: 10px;">
curl -X POST http://localhost:3000/api/parse-custom \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://example.com/catalog",
    "selectors": {
      "products": ".product",
      "name": ".title",
      "price": ".cost",
      "composition": ".material",
      "discount": ".sale"
    }
  }'
                    </div>
                </div>

                <div class="endpoint-doc">
                    <span class="method method-get">GET</span>
                    <strong>/api/configs</strong>
                    <p style="margin-top: 8px;">–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π</p>
                    <div class="code-block" style="margin-top: 10px;">
curl http://localhost:3000/api/configs
                    </div>
                </div>

                <div class="endpoint-doc">
                    <span class="method method-get">GET</span>
                    <strong>/api/results/:id</strong>
                    <p style="margin-top: 8px;">–ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–æ ID</p>
                </div>

                <div class="endpoint-doc">
                    <span class="method method-post">POST</span>
                    <strong>/webhook/n8n</strong>
                    <p style="margin-top: 8px;">Webhook –¥–ª—è n8n - –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –∏–∑ workflow</p>
                </div>
            </div>
        </div>

        <!-- n8n Integration Tab -->
        <div id="n8n" class="tab-content">
            <div class="card">
                <h3>üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å n8n</h3>
                <p style="margin-bottom: 20px; color: #cbd5e1;">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–∞—Ä—Å–µ—Ä–∞ –∫ n8n workflows</p>

                <h4 style="margin-top: 20px; margin-bottom: 10px; color: var(--color-primary);">1Ô∏è‚É£ HTTP Request —É–∑–µ–ª –≤ n8n</h4>
                <div class="code-block">URL: http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:3000/api/parse
Method: POST
Authentication: None (–∏–ª–∏ Basic –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏)
Headers:
  Content-Type: application/json
Body (JSON):
{
  "url": "{{ $json.catalog_url }}",
  "configName": "{{ $json.shop_name }}",
  "limit": 100
}</div>

                <h4 style="margin-top: 20px; margin-bottom: 10px; color: var(--color-primary);">2Ô∏è‚É£ Webhook —Å–ø–æ—Å–æ–± (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</h4>
                <p style="margin-bottom: 10px; color: #cbd5e1;">–°–æ–∑–¥–∞–π—Ç–µ –≤ n8n Webhook trigger –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å—é–¥–∞:</p>
                <div class="code-block">POST /webhook/n8n
Payload:
{
  "url": "https://bml.ru/odezhda",
  "configName": "bml",
  "limit": 50,
  "webhook_return_url": "{{ $json.webhook_url }}"
}</div>

                <h4 style="margin-top: 20px; margin-bottom: 10px; color: var(--color-primary);">3Ô∏è‚É£ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ n8n</h4>
                <p style="margin-bottom: 10px; color: #cbd5e1;">–ü–æ–ª—É—á–∏—Ç–µ JSON –æ—Ç–≤–µ—Ç:</p>
                <div class="code-block">{
  "status": "success",
  "timestamp": "2025-12-03T12:00:00.000Z",
  "data": {
    "url": "https://bml.ru/odezhda",
    "itemsCount": 50,
    "products": [
      {
        "name": "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∫–æ—Å—Ç—é–º",
        "price": "2499 ‚ÇΩ",
        "composition": "80% –ø–æ–ª–∏—ç—Å—Ç–µ—Ä, 20% —Ö–ª–æ–ø–æ–∫",
        "discount": "-30%",
        "url": "..."
      }
    ],
    "executionTime": 2345
  }
}</div>

                <h4 style="margin-top: 20px; margin-bottom: 10px; color: var(--color-primary);">üìö –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π n8n workflow</h4>
                <p style="color: #cbd5e1; margin-bottom: 15px;">Trigger ‚Üí HTTP Request (–ø–∞—Ä—Å–µ—Ä) ‚Üí Google Sheets (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ) ‚Üí Webhook (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ)</p>
                <div class="status-box status-info">
                    –ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON. 
                    –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ Supabase, Google Sheets, –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö –≤ n8n.
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/api';

        function switchTab(e, tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            e.target.classList.add('active');
        }

        async function parseNow() {
            const url = document.getElementById('parserUrl').value;
            const selector = document.getElementById('parserSelector').value;
            const nameSelector = document.getElementById('parserName').value;
            const priceSelector = document.getElementById('parserPrice').value;
            const compositionSelector = document.getElementById('parserComposition').value;
            const discountSelector = document.getElementById('parserDiscount').value;
            const limit = document.getElementById('parserLimit').value;

            if (!url || !selector) {
                showStatus('parserStatus', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ URL –∏ —Å–µ–ª–µ–∫—Ç–æ—Ä —Ç–æ–≤–∞—Ä–æ–≤', 'error');
                return;
            }

            showStatus('parserStatus', '<span class="loading"></span>–ü–∞—Ä—Å–∏–Ω–≥ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ...', 'info');

            try {
                const response = await fetch(`${API_BASE}/api/parse-custom`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        url,
                        limit: parseInt(limit),
                        selectors: {
                            products: selector,
                            name: nameSelector || '.name',
                            price: priceSelector || '.price',
                            composition: compositionSelector || '.composition',
                            discount: discountSelector || '.discount'
                        }
                    })
                });

                const data = await response.json();
                if (data.status === 'success') {
                    showStatus('parserStatus', `‚úì –£—Å–ø–µ—à–Ω–æ! –†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ ${data.data.products.length} —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞ ${data.data.executionTime}ms`, 'success');
                    displayResults(data.data.products);
                } else {
                    showStatus('parserStatus', `‚úó –û—à–∏–±–∫–∞: ${data.error}`, 'error');
                }
            } catch (error) {
                showStatus('parserStatus', `‚úó –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}`, 'error');
            }
        }

        function displayResults(products) {
            const container = document.getElementById('resultsContainer');
            const list = document.getElementById('resultsList');
            list.innerHTML = '';

            products.forEach((product, index) => {
                const item = document.createElement('div');
                item.className = 'result-item';
                item.innerHTML = `
                    <h4>${index + 1}. ${product.name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h4>
                    <div class="price">${product.price || '–¶–µ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'}</div>
                    ${product.composition ? `<p><strong>–°–æ—Å—Ç–∞–≤:</strong> ${product.composition}</p>` : ''}
                    ${product.discount ? `<p><strong>–ê–∫—Ü–∏—è:</strong> ${product.discount}</p>` : ''}
                    ${product.url ? `<p><strong>URL:</strong> <a href="${product.url}" target="_blank" style="color: #7dd3fc;">${product.url.substring(0, 50)}...</a></p>` : ''}
                `;
                list.appendChild(item);
            });

            container.style.display = 'block';
        }

        function resetParser() {
            document.getElementById('parserUrl').value = '';
            document.getElementById('parserSelector').value = '';
            document.getElementById('parserName').value = '';
            document.getElementById('parserPrice').value = '';
            document.getElementById('parserComposition').value = '';
            document.getElementById('parserDiscount').value = '';
            document.getElementById('parserStatus').innerHTML = '';
            document.getElementById('resultsContainer').style.display = 'none';
        }

        async function saveConfig() {
            const name = document.getElementById('configName').value;
            const domain = document.getElementById('configDomain').value;
            const config = document.getElementById('configJson').value;

            if (!name || !domain || !config) {
                showStatus('configStatus', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/config/save`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, domain, config: JSON.parse(config) })
                });

                const data = await response.json();
                if (data.status === 'success') {
                    showStatus('configStatus', '‚úì –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞', 'success');
                    loadConfigs();
                } else {
                    showStatus('configStatus', `‚úó –û—à–∏–±–∫–∞: ${data.error}`, 'error');
                }
            } catch (error) {
                showStatus('configStatus', `‚úó –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        async function loadConfigs() {
            try {
                const response = await fetch(`${API_BASE}/api/configs`);
                const data = await response.json();

                const list = document.getElementById('configsList');
                list.innerHTML = '';

                if (data.configs.length === 0) {
                    list.innerHTML = '<p style="color: #94a3b8;">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π</p>';
                    return;
                }

                data.configs.forEach(cfg => {
                    const item = document.createElement('div');
                    item.className = 'status-box status-info';
                    item.style.marginBottom = '10px';
                    item.innerHTML = `
                        <strong>${cfg.name}</strong> (${cfg.domain})
                        <pre style="margin-top: 8px; font-size: 11px;">${JSON.stringify(cfg.config, null, 2)}</pre>
                    `;
                    list.appendChild(item);
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤:', error);
            }
        }

        function showStatus(elementId, message, type) {
            const el = document.getElementById(elementId);
            el.className = `status-box status-${type}`;
            el.innerHTML = message;
            el.style.display = 'block';
        }

        // Load configs on page load
        loadConfigs();
    </script>
</body>
</html>
